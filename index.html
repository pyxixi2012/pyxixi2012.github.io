<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://pyxixi2012.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternative" href="[object Object]" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xwpgr.com1.z0.glb.clouddn.com/logo.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">pyxixi2012</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">home</a></li>
				        
							<li><a href="/categories">categories</a></li>
				        
							<li><a href="/tags">tags</a></li>
				        
							<li><a href="/archives">archives</a></li>
				        
							<li><a href="/about">about</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="http://pyxixi2012.github.io" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/atom/" style="font-size: 10px;">atom</a> <a href="/tags/docker/" style="font-size: 18px;">docker</a> <a href="/tags/flume/" style="font-size: 12px;">flume</a> <a href="/tags/git/" style="font-size: 20px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/kafka/" style="font-size: 14px;">kafka</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/python/" style="font-size: 16px;">python</a> <a href="/tags/spark/" style="font-size: 10px;">spark</a> <a href="/tags/zookeeper/" style="font-size: 12px;">zookeeper</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://docker.io/">Docker IO</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://stackoverflow.com">Stackoverflow</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://slideshare.net">Slideshare</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://github.com">Github</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://python.org/">python org</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">老程序员一枚，互联网新兵，会点python，对docker感兴趣，做过点大叔据的东西，对nodejs，angular.js也挺感兴趣，就是感觉时间太少，太多的书没时间看，让我再年轻10岁吧 ～～～～</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">pyxixi2012</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://7xwpgr.com1.z0.glb.clouddn.com/logo.png" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">pyxixi2012</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">home</a></li>
		        
					<li><a href="/categories">categories</a></li>
		        
					<li><a href="/tags">tags</a></li>
		        
					<li><a href="/archives">archives</a></li>
		        
					<li><a href="/about">about</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="http://pyxixi2012.github.io" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-2016/Install atom plugin -- markdown writer" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/23/2016/Install atom plugin -- markdown writer/" class="article-date">
  	<time datetime="2016-07-23T05:11:00.000Z" itemprop="datePublished">2016-07-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/23/2016/Install atom plugin -- markdown writer/">Install atom plugin -- markdown writer</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>aa</th>
<th>bb</th>
<th>cc</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/atom/">atom</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/markdown/">markdown</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/atom/">atom</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-学习Hexo，搭建一个git-pages的博客" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/23/学习Hexo，搭建一个git-pages的博客/" class="article-date">
  	<time datetime="2016-07-23T02:35:52.000Z" itemprop="datePublished">2016-07-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/23/学习Hexo，搭建一个git-pages的博客/">学习Hexo，搭建一个git pages的博客</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="faqs"><a href="#faqs" class="headerlink" title="faqs"></a>faqs</h3><blockquote>
<p>建立了一个hexo基于yilia的简单博客，把之前写过的一些东西陆续的上传到这里<br>过程其实比较简单，因为个人风格喜欢简约，所以选择了yilia的简约风格theme<br>尝试了duoshuo 和 disqus ,感觉还是disqus更符合我的风格，但是有点不太明白的是，为啥多说的配置在theme的_config.yml ,而disqus的配置却在hexo的_config.yml ,不懂～</p>
<p>目前发布git pages 还是使用http方式，逐步会改到ssh方式</p>
<p>计划写些自动发布的脚本，一个是方便deploy ，也是可以把之前的一些资料快速转移</p>
<p>deploy到github后，用img的标签的图像不能正常显示，main.js报错，不能加show classname ，我用的firefox浏览器，可能是证书信任关系导致的，关闭protect就可以显示了</p>
</blockquote>
<h3 id="常用的参考资料"><a href="#常用的参考资料" class="headerlink" title="常用的参考资料"></a>常用的参考资料</h3><p><a href="https://hexo.io/zh-cn/" title="Hexo" target="_blank" rel="external">Hexo 中文参考</a></p>
<p><a href="https://github.com/LouisBarranqueiro" title="hexo-theme-tranquilpeak" target="_blank" rel="external">hexo-theme-tranquilpeak</a></p>
<p><a href="https://github.com/ppoffice/hexo-theme-hueman" title="hexo-theme-hueman" target="_blank" rel="external">hexo-theme-hueman</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/">hexo</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/hexo/">hexo</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-install_docker_spark" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/install_docker_spark/" class="article-date">
  	<time datetime="2016-07-22T12:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/install_docker_spark/">Install spark 1.6.0 with docker</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Install-docker-on-cent-os-7-with-the-script"><a href="#Install-docker-on-cent-os-7-with-the-script" class="headerlink" title="Install docker on cent os 7 with the script"></a>Install docker on cent os 7 with the script</h2><ol>
<li><p>sudo yum update</p>
</li>
<li><p>sudo curl -fsSL <a href="https://get.docker.com/" target="_blank" rel="external">https://get.docker.com/</a> | sh</p>
</li>
<li><p>sudo service docker start</p>
</li>
<li><p>sudo usermod -aG docker yunwei</p>
</li>
<li><p>sudo docker run hello-world</p>
</li>
<li><p>sudo chkconfig docker on</p>
</li>
<li><p>close SELinux</p>
</li>
</ol>
<h2 id="Uninstall"><a href="#Uninstall" class="headerlink" title="Uninstall"></a>Uninstall</h2><ol>
<li><p>sudo yum list installed | grep docker</p>
</li>
<li><p>sudo yum -y remove docker-engine.x86_64</p>
</li>
<li><p>sudo rm -rf /var/lib/docker</p>
</li>
</ol>
<h2 id="Export-docker-images-from-existing-images"><a href="#Export-docker-images-from-existing-images" class="headerlink" title="Export docker images from existing images"></a>Export docker images from existing images</h2><ol>
<li><p>sudo docker save -o sequenceiq.hadoop-docker.tar 679730efaea5</p>
</li>
<li><p>sudo docker save -o sequenceiq.spark.tar 4f0d42f5530a</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[zgg@iZ25ff0xryjZ docker_export_tar]$ ll</div><div class="line">total 4627324</div><div class="line">-rw-r--r-- 1 root root 1805244928 Mar 29 09:47 sequenceiq.hadoop-docker.tar</div><div class="line">-rw-r--r-- 1 root root 2933123072 Mar 29 09:41 sequenceiq.spark.tar</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Import-docker-iamges-from-exported-tar-file"><a href="#Import-docker-iamges-from-exported-tar-file" class="headerlink" title="Import docker iamges from exported tar file"></a>Import docker iamges from exported tar file</h2><ol>
<li>sudo docker </li>
<li><p>–input sequenceiq.hadoop-docker.tar</p>
</li>
<li><p>sudo docker tag 789fa0a3b911 sequenceiq/hadoop-docker:2.7.0</p>
</li>
<li><p>sudo docker load –input sequenceiq.spark.tar</p>
</li>
<li><p>sudo docker tag 40a687b3cdcc sequenceiq/spark:1.6.0</p>
</li>
<li><p>sudo docker kill $(sudo docker ps -q) ; sudo docker rm $(sudo docker ps -a -q)</p>
</li>
</ol>
<h2 id="Run-hadoop-docker-and-test"><a href="#Run-hadoop-docker-and-test" class="headerlink" title="Run hadoop-docker and test"></a>Run hadoop-docker and test</h2><ol>
<li><p>git clone <a href="https://github.com/sequenceiq/hadoop-docker.git" target="_blank" rel="external">https://github.com/sequenceiq/hadoop-docker.git</a></p>
</li>
<li><p>sudo cp bootstrap.sh /etc/.</p>
</li>
<li><p>sudo docker run -it sequenceiq/hadoop-docker:2.7.0 /etc/bootstrap.sh -bash</p>
</li>
<li><p>test ,run examples</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">cd $HADOOP_PREFIX</div><div class="line"># run the mapreduce</div><div class="line">bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.1.jar grep input output &apos;dfs[a-z.]+&apos;</div><div class="line"></div><div class="line"># check the output</div><div class="line">bin/hdfs dfs -cat output/*</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Run-spark-docker-and-test"><a href="#Run-spark-docker-and-test" class="headerlink" title="Run spark-docker and test"></a>Run spark-docker and test</h2><ol>
<li><p>git clone <a href="https://github.com/sequenceiq/hadoop-docker.git" target="_blank" rel="external">https://github.com/sequenceiq/hadoop-docker.git</a></p>
</li>
<li><p>sudo docker run -it -p 8088:8088 -p 8042:8042 -p 4040:4040 -h sandbox sequenceiq/spark:1.6.0 bash<br>or docker run -d -h sandbox sequenceiq/spark:1.6.0 -d</p>
</li>
<li><p>test ,run examples</p>
<p>$ ./pyspark</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">copy readme.md to hdfs /user/root</div><div class="line"></div><div class="line">$ hadoop fs -put ./README.md /user/root/data/README.md</div><div class="line">$ hadoop fs -ls /usr/root/data</div><div class="line"></div><div class="line">$ ./pyspark</div><div class="line">&gt;&gt;&gt; file = sc.textFile(&quot;hdfs:///user/root/README.md&quot;)</div><div class="line">95</div><div class="line"></div><div class="line">$ spark-shell \</div><div class="line">  --master yarn-client \</div><div class="line">  --driver-memory 1g \</div><div class="line">  --executor-memory 1g \</div><div class="line">  --executor-cores 1</div><div class="line"></div><div class="line">scala&gt; val file = sc.textFile(&quot;hdfs:///user/root/data/README.md&quot;)</div><div class="line">res1: Long = 95</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">  YARN-client mode</div><div class="line"></div><div class="line"># run the spark shell</div><div class="line">spark-shell \</div><div class="line">--master yarn-client \</div><div class="line">--driver-memory 1g \</div><div class="line">--executor-memory 1g \</div><div class="line">--executor-cores 1</div><div class="line"></div><div class="line"># execute the the following command which should return 1000</div><div class="line">scala&gt; sc.parallelize(1 to 1000).count()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">YARN-cluster mode</div><div class="line"></div><div class="line">In yarn-cluster mode, the Spark driver runs inside an application master process which is managed by YARN on the cluster, and the client can go away after initiating the application.</div><div class="line"></div><div class="line">Estimating Pi (yarn-cluster mode):</div><div class="line"></div><div class="line"># execute the the following command which should write the &quot;Pi is roughly 3.1418&quot; into the logs</div><div class="line"># note you must specify --files argument in cluster mode to enable metrics</div><div class="line">spark-submit \</div><div class="line">--class org.apache.spark.examples.SparkPi \</div><div class="line">--files $SPARK_HOME/conf/metrics.properties \</div><div class="line">--master yarn-cluster \</div><div class="line">--driver-memory 1g \</div><div class="line">--executor-memory 1g \</div><div class="line">--executor-cores 1 \</div><div class="line">$SPARK_HOME/lib/spark-examples-1.6.0-hadoop2.6.0.jar</div><div class="line">Estimating Pi (yarn-client mode):</div><div class="line"></div><div class="line"># execute the the following command which should print the &quot;Pi is roughly 3.1418&quot; to the screen</div><div class="line">spark-submit \</div><div class="line">--class org.apache.spark.examples.SparkPi \</div><div class="line">--master yarn-client \</div><div class="line">--driver-memory 1g \</div><div class="line">--executor-memory 1g \</div><div class="line">--executor-cores 1 \</div><div class="line">$SPARK_HOME/lib/spark-examples-1.6.0-hadoop2.6.0.jar</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spark/">spark</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-kafka-docker-usage" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/kafka-docker-usage/" class="article-date">
  	<time datetime="2016-07-22T11:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/kafka-docker-usage/">kafka with docker 常用命令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="kafka-docker"><a href="#kafka-docker" class="headerlink" title="kafka-docker"></a>kafka-docker</h1><p>Dockerfile for <a href="http://kafka.apache.org/" target="_blank" rel="external">Apache Kafka</a></p>
<p>The image is available directly from <a href="https://registry.hub.docker.com/" target="_blank" rel="external">https://registry.hub.docker.com/</a></p>
<h2 id="Pre-Requisites"><a href="#Pre-Requisites" class="headerlink" title="Pre-Requisites"></a>Pre-Requisites</h2><ul>
<li>install docker-compose <a href="https://docs.docker.com/compose/install/" target="_blank" rel="external">https://docs.docker.com/compose/install/</a></li>
<li>modify the <figure class="highlight plain"><figcaption><span>in ```docker-compose.yml``` to match your docker host IP (Note: Do not use localhost or 127.0.0.1 as the host ip if you want to run multiple brokers.)</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- if you want to customise any Kafka parameters, simply add them as environment variables in ```docker-compose.yml```, e.g. in order to increase the ```message.max.bytes``` parameter set the environment to ```KAFKA_MESSAGE_MAX_BYTES: 2000000```. To turn off automatic topic creation set ```KAFKA_AUTO_CREATE_TOPICS_ENABLE: &apos;false&apos;</div></pre></td></tr></table></figure></li>
</ul>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><p>Start a cluster:</p>
<ul>
<li><figure class="highlight plain"><figcaption><span>up -d ```</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">Add more brokers:</div><div class="line"></div><div class="line">- ```docker-compose scale kafka=3</div></pre></td></tr></table></figure>
</li>
</ul>
<p>Destroy a cluster:</p>
<ul>
<li><figure class="highlight plain"><figcaption><span>stop```</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">## Note</div><div class="line"></div><div class="line">The default ```docker-compose.yml``` should be seen as a starting point. By default each broker will get a new port number and broker id on restart. Depending on your use case this might not be desirable. If you need to use specific ports and broker ids, modify the docker-compose configuration accordingly, e.g. [docker-compose-single-broker.yml](https://github.com/wurstmeister/kafka-docker/blob/master/docker-compose-single-broker.yml):</div><div class="line"></div><div class="line">- ```docker-compose -f docker-compose-single-broker.yml up</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Broker-IDs"><a href="#Broker-IDs" class="headerlink" title="Broker IDs"></a>Broker IDs</h2><p>If you don’t specify a broker id in your docker-compose file, it will automatically be generated based on the name that docker-compose gives the container. This allows scaling up and down. In this case it is recommended to use the <code>--no-recreate</code> option of docker-compose to ensure that containers are not re-created and thus keep their names and ids.</p>
<h2 id="Automatically-create-topics"><a href="#Automatically-create-topics" class="headerlink" title="Automatically create topics"></a>Automatically create topics</h2><p>If you want to have kafka-docker automatically create topics in Kafka during<br>creation, a <code>KAFKA_CREATE_TOPICS</code> environment variable can be<br>added in <code>docker-compose.yml</code>.</p>
<p>Here is an example snippet from <code>docker-compose.yml</code>:</p>
<pre><code>environment:
  KAFKA_CREATE_TOPICS: &quot;Topic1:1:3,Topic2:1:1&quot;
</code></pre><p><code>Topic 1</code> will have 1 partition and 3 replicas, <code>Topic 2</code> will have 1 partition and 1 replica.</p>
<h2 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h2><p><a href="http://wurstmeister.github.io/kafka-docker/" target="_blank" rel="external">http://wurstmeister.github.io/kafka-docker/</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-install-flume-with-docker" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/install-flume-with-docker/" class="article-date">
  	<time datetime="2016-07-22T06:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/install-flume-with-docker/">安装Flume docker image</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>当 Docker 安装完成之后，你需要启动 docker 进程。  </p>
<blockquote>
<p>$ sudo service docker start<br>如果我们希望 Docker 默认开机启动，如下操作：  </p>
<p>$ sudo chkconfig docker on<br>现在，我们来验证 Docker 是否正常工作。第一步，我们需要下载最新的 centos 镜像。  </p>
<p>$ sudo docker pull hello-world  </p>
</blockquote>
<p>下一步，我们运行下边的命令来查看镜像，确认镜像是否存在：  </p>
<blockquote>
<p>$ sudo docker images hello-world  </p>
</blockquote>
<h3 id="pull-flume-image-and-build-new-image"><a href="#pull-flume-image-and-build-new-image" class="headerlink" title="pull flume image and build new image"></a>pull flume image and build new image</h3><p>1.pull flume image from docker hub  </p>
<blockquote>
<p>$ sudo docker pull probablyfine/flume  </p>
</blockquote>
<p>2.edit flume conf   </p>
<blockquote>
<p>view flume-http.conf  </p>
</blockquote>
<p>3.build new flume image from Dockerfile  </p>
<blockquote>
<p>$ cd /data/work/app/docker/flume<br>$ sudo docker build -t zhiguoguo/flume-http .  </p>
</blockquote>
<p>3.check builded flume image   </p>
<blockquote>
<p>$ sudo docker images|grep flume-http  </p>
</blockquote>
<p>4.fun flume image   </p>
<blockquote>
<p>$ sudo docker run -d -p 444:50004 -t zhiguoguo/flume-http</p>
</blockquote>
<p>5.view running container logs</p>
<blockquote>
<p>$ sudo docker logs $(sudo docker ps -q)  </p>
</blockquote>
<p>6.stop running container</p>
<blockquote>
<p>$ sudo docker stop $(sudo docker ps -q)  </p>
</blockquote>
<p>7.test git</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flume/">flume</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-install-pyxixi2012-blog" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/install-pyxixi2012-blog/" class="article-date">
  	<time datetime="2016-07-22T06:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/install-pyxixi2012-blog/">Create a blog on github</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="create-a-project-on-github-named-pyxixi2012-github-io"><a href="#create-a-project-on-github-named-pyxixi2012-github-io" class="headerlink" title="create a project on github named pyxixi2012.github.io"></a>create a project on github named pyxixi2012.github.io</h3><pre><code>$ git clone git clone https://github.com/pyxixi2012/pyxixi2012.github.io
$ cd pyxixi2012.github.io/
$ echo &quot;hello world&quot; &gt;&gt; index.html
$ git config --global user.email &quot;pyxixi2012@gmail.com&quot;
$ git config --global user.user &quot;pyxixi2012&quot;
$ git add --all
$ git commit -m &quot; Init push a blog site files &quot;
$ git push -u origin master
$ curl -i http://pyxixi2012.github.io
</code></pre><h3 id="create-a-blog-depand-on-jekyll"><a href="#create-a-blog-depand-on-jekyll" class="headerlink" title="create a blog depand on jekyll"></a>create a blog depand on jekyll</h3><pre><code>$ sudo apt-get install -y ruby
$ sudo apt-get install -y ruby-dev
$ sudo apt-get install -y gem
$ sudo gem install jekyll
$ jekyll new my-site
$ cd my-site
$ jekyll serve

view page by http://127.0.0.1:4000
</code></pre><h3 id="create-a-blog-depand-on-Hexo-https-github-com-wuchong-jacman"><a href="#create-a-blog-depand-on-Hexo-https-github-com-wuchong-jacman" class="headerlink" title="create a blog depand on Hexo , https://github.com/wuchong/jacman"></a>create a blog depand on Hexo , <a href="https://github.com/wuchong/jacman" target="_blank" rel="external">https://github.com/wuchong/jacman</a></h3><pre><code>1. install git
  $ sudo apt-get install git-core
2. install Nodejs
  $ wget -qO- https://raw.github.com/creationix/nvm/master/install.sh | sh
  $ nvm install stable
3. install hexo
  $ npm install -g hexo-cli
4. create a new hexo blog site
  $ hexo init my-site
  $ cd my-site
  $ npm install
  $ hexo server
  $ curl -i http://127.0.0.1:4000
5. use jacman themes
  $ git clone https://github.com/wuchong/jacman.git themes/jacman
  $ cp _config.yml _config.yml.old
  $ vi _config.yml   # replace themes us jacman 
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-install_flume_kafka_zookeeper_python_docker" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/install_flume_kafka_zookeeper_python_docker/" class="article-date">
  	<time datetime="2016-07-22T06:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/install_flume_kafka_zookeeper_python_docker/">安装flume zookeeper  kafka python 环境 基于docker image</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><p><a href="#1">1. install and config docker </a></p>
<ul>
<li><p><a href="#1.1">1.1 check cent os 7 kernel version</a></p>
</li>
<li><p><a href="#1.2">1.2 config docker env</a></p>
</li>
<li><p><a href="#1.3">1.3 Starting and config the Docker daemon</a></p>
</li>
</ul>
</li>
<li><p><a href="#2">2. create flume docker image </a></p>
</li>
<li><p><a href="#3">3. create kafka docker image </a></p>
<ul>
<li><p><a href="#3.1">3.1 install kafka without docker </a></p>
</li>
<li><p><a href="#3.2">3.2 install kafka with docker </a></p>
</li>
</ul>
</li>
<li><p><a href="#13">13. dockerfile for flume http agent </a></p>
</li>
<li><p><a href="#14">14. config file for flume http agent </a></p>
</li>
</ul>
<h2 id="1"> 1. about docker </h2>

<h5 id="1.1">1.1 check cent os 7 kernel version </h5>

<ol>
<li><p>check cent os 7 kernel version</p>
<blockquote>
<p>uname -r</p>
</blockquote>
</li>
<li><p>upgrade cent os 7</p>
<blockquote>
<p>$sudo yum -r update</p>
</blockquote>
</li>
<li><p>mondify net config (aliyun)</p>
<blockquote>
<p>$sudo brctl addbr docker0</p>
<p>$sudo brctl addif docker0 eth0</p>
<p>$sudo ip link set dev docker0 up</p>
<p>$sudo ifconfig docker0 172.17.42.1</p>
</blockquote>
</li>
<li><p>install docker</p>
<blockquote>
<p>usefull link:</p>
<p><a href="http://www.widuu.com/chinese_docker/docker-hub/builds.html" target="_blank" rel="external">http://www.widuu.com/chinese_docker/docker-hub/builds.html</a></p>
<p><a href="http://probablyfine.co.uk/2014/05/05/using-docker-with-apache-flume-1/" target="_blank" rel="external">http://probablyfine.co.uk/2014/05/05/using-docker-with-apache-flume-1/</a></p>
</blockquote>
<p>Install with the script</p>
<p>Log into your machine as a user with sudo or root privileges.</p>
<p>Make sure your existing yum packages are up-to-date.</p>
<blockquote>
<p>$ sudo yum update</p>
</blockquote>
<p>Run the Docker installation script.</p>
<blockquote>
<p>$ curl -sSL <a href="https://get.docker.com/" target="_blank" rel="external">https://get.docker.com/</a> | sh</p>
</blockquote>
<p>This script adds the docker.repo repository and installs Docker.</p>
<p>Start the Docker daemon.</p>
<blockquote>
<p>$ sudo service docker start</p>
</blockquote>
<p>Verify docker is installed correctly by running a test image in a container.</p>
<blockquote>
<p>$ sudo docker run hello-world</p>
</blockquote>
<p>Display docker version</p>
<blockquote>
<p>$ sudo docker version</p>
<p>Client:</p>
<p>Version:      1.9.1<br>API version:  1.21<br>Go version:   go1.4.2<br>Git commit:   a34a1d5<br>Built:        Fri Nov 20 13:25:01 UTC 2015<br>OS/Arch:      linux/amd64  </p>
<p>Server:<br> Version:      1.9.1<br>API version:  1.21<br>Go version:   go1.4.2<br>Git commit:   a34a1d5<br>Built:        Fri Nov 20 13:25:01 UTC 2015<br>OS/Arch:      linux/amd64</p>
</blockquote>
<p>Create a docker group</p>
<p>To create the docker group and add your user:</p>
<p>Log into Centos as a user with sudo privileges.</p>
<p>Create the docker group and add your user.</p>
<blockquote>
<p>$sudo usermod -aG docker yang</p>
</blockquote>
<p>Log out and log back in.</p>
<p>This ensures your user is running with the correct permissions.</p>
<p>Verify your work by running docker without sudo.</p>
<blockquote>
<p>$ sudo docker run hello-world</p>
<p>$ sudo docker  pull centos</p>
<p>$sudo docker run -it centos /bin/bash</p>
</blockquote>
<p>Start the docker daemon at boot</p>
<p>To ensure Docker starts when you boot your system, do the following:</p>
<blockquote>
<p>$ sudo chkconfig docker on</p>
</blockquote>
<p>Enter container shell with exec</p>
<blockquote>
<p>$ sudo docker ps<br>$ sudo docker exec -it 069774caa841  /bin/bash</p>
</blockquote>
</li>
<li><p>install docker-compose<br>install docker-compose from curl script ,install lastest version</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$su -i</div><div class="line"></div><div class="line">$curl -L https://github.com/docker/compose/releases/download/1.5.1/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</div><div class="line"></div><div class="line">#1.6.2</div><div class="line"></div><div class="line">$ curl -L https://github.com/docker/compose/releases/download/1.6.2/run.sh &gt; /usr/local/bin/docker-compose</div><div class="line"></div><div class="line">$chmod +x /usr/local/bin/docker-compose</div><div class="line"></div><div class="line">sudo docker-compose --version</div><div class="line"></div><div class="line">docker-compose version: 1.5.1</div></pre></td></tr></table></figure>
</li>
<li><p>uninstal docker</p>
<p>You can uninstall the Docker software with yum.</p>
<ul>
<li><p>List the package you have installed.</p>
<blockquote>
<p>$ yum list installed | grep docker  </p>
<p>docker-engine.x86_64   1.7.1-1.el7 @/docker-engine-1.7.1-1.el7.x86_64.rpm</p>
</blockquote>
</li>
<li><p>Remove the package.</p>
<blockquote>
<p>$ sudo yum -y remove docker-engine.x86_64</p>
<p>This command does not remove images, containers, volumes, or user-created configuration files on your host.</p>
</blockquote>
</li>
<li><p>To delete all images, containers, and volumes, run the following command:</p>
<blockquote>
<p>$ rm -rf /var/lib/docker</p>
<p>Locate and delete any user-created configuration files.</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<h2 id="1-2-config-docker-env"><a href="#1-2-config-docker-env" class="headerlink" title="1.2 config docker env"></a>1.2 config docker env</h2><ol>
<li><p>配置Docker开机自启动：</p>
<blockquote>
<p>$systemctl enable docker.service</p>
</blockquote>
<p>If you need to add an HTTP Proxy, set a different directory or partition for the Docker runtime files, or make other customizations, read our Systemd article to learn how to customize your Systemd Docker daemon options.</p>
</li>
<li><p>卸载,使用yum卸载Docker。</p>
<p>列出安装的软件包</p>
<blockquote>
<p>$yum list installed | grep docker</p>
<p>$yum list installed | grep docker</p>
<p>docker-engine.x86_64             1.8.1-1.el7.centos<br>dockerrepo docker-selinux.x86_64            1.7.1-108.el7.centos   </p>
</blockquote>
<p>移除软件包</p>
<blockquote>
<p>$ sudo yum -y remove docker-engine.x86_64</p>
</blockquote>
<p>上面的命令不会删除镜像，容器，卷组和用户自配置文件。</p>
<p>删除所有镜像，容器和卷组</p>
<blockquote>
<p>$ rm -rf /var/lib/docker</p>
</blockquote>
<p>删除用户自配置文件</p>
</li>
</ol>
<h5 id="1.3"> 1.3 Starting and config the Docker daemon </h5>

<ol>
<li><p>当 Docker 安装完成之后，你需要启动 docker 进程。</p>
<blockquote>
<p> $sudo systemctl start docker.service</p>
</blockquote>
</li>
<li><p>如果我们希望 Docker 默认开机启动，如下操作：</p>
<blockquote>
<p>$sudo chkconfig docker on</p>
</blockquote>
</li>
<li><p>现在，我们来验证 Docker 是否正常工作。第一步，我们需要下载最新的 centos 镜像。</p>
<blockquote>
<p>$sudo docker pull centos</p>
</blockquote>
</li>
<li><p>下一步，我们运行下边的命令来查看镜像，确认镜像是否存在：</p>
<blockquote>
<p>$ sudo docker images centos</p>
</blockquote>
</li>
</ol>
<h2 id="2">2. create flume docker image </h2>

  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">usefull link :</div><div class="line"></div><div class="line">#Using Docker with Apache Flume - Part 1</div><div class="line">http://segmentfault.com/a/1190000000504942</div><div class="line"></div><div class="line">#config kafk sink with Zookeeper</div><div class="line">http://www.cloudera.com/content/www/en-us/documentation/kafka/latest/topics/kafka_flume.html</div></pre></td></tr></table></figure>
<ol>
<li><p>mkdir flume work dir</p>
<blockquote>
<p>$mkdir /data/work/app/docker/flume</p>
</blockquote>
</li>
<li><p>create Dockerfile</p>
<blockquote>
<p>FROM probablyfine/flume</p>
<p>ADD ./flume-http.conf /var/tmp/flume-http.conf</p>
<p>EXPOSE 50004</p>
<p>ENTRYPOINT [ “flume-ng”, “agent”, “-c”, “/opt/flume/conf”, “-f”, “/var/tmp/flume-http.conf”, “-n”, “a1”, “-Dflume.root.logger=INFO,console” ]</p>
</blockquote>
</li>
<li><p>make flume-http.conf</p>
<blockquote>
<p>$cp /home/yang/app/apache-flume-1.6.0-bin/conf/flume-http ./flume-http.conf</p>
</blockquote>
</li>
<li><p>build docker-flume images</p>
<blockquote>
<p>$sudo docker build -t zhiguoguo/flume-http .</p>
</blockquote>
</li>
<li><p>display flume-http images</p>
<blockquote>
<p>$docker images |grep flume-http</p>
<p>zhiguoguo/flume-http     latest              d14cf0b3723b        6 minutes ago       418.9 MB</p>
<p>probablyfine/flume       latest              030613242e61        3 months ago        418.9 MB</p>
</blockquote>
</li>
<li><p>push flume-http to private repository</p>
<blockquote>
<p>mark</p>
</blockquote>
</li>
<li><p>run flume-http image</p>
<blockquote>
<p>$sudo docker run -d -p 444:50004 -t zhiguoguo/flume-http<br>$sudo docker ps|grep flume-http<br>$sudo docker logs  be7a4c50e159</p>
</blockquote>
</li>
<li><p>stop running container</p>
<blockquote>
<p>$ sudo docker stop</p>
</blockquote>
</li>
<li><p>remove images</p>
<blockquote>
<p>$ docker rm test_sshd<br>$ docker rmi eg_sshd</p>
</blockquote>
</li>
</ol>
<h2 id="3">3. create kafka docker image </h2>

<h5 id="3.1">3.1 install kafka without docker </h5>

<p>  1). start zookeeper server at localhost  </p>
<blockquote>
<p>$zookeeper-3.4.6/bin/zkServer.sh start</p>
</blockquote>
<p>  2). start kafka broker 1  </p>
<blockquote>
<p>$bin/kafka-server-start.sh config/server.properties     </p>
</blockquote>
<p>  3). create a topic ‘email’  </p>
<blockquote>
<p>$bin/kafka-topics.sh –create –zookeeper localhost:2181 –replication-factor 1 –partitions 1 –topic email   </p>
</blockquote>
<p>  4). list all kafka topic</p>
<blockquote>
<p>$bin/kafka-topics.sh –list –zookeeper localhost:2181</p>
</blockquote>
<p>  5). view topic’s properties   </p>
<blockquote>
<p>$ bin/kafka-topics.sh –describe –zookeeper localhost:2181 –topic email</p>
</blockquote>
<p>  6). begin test kafka cluster broker  ,producers and consumer</p>
<p>  Created topic “email”, “sms”.  </p>
<blockquote>
<p>$ bin/kafka-topics.sh –create –zookeeper localhost:2181 –replication-factor 1 –partitions 1 –topic email</p>
<p>$ bin/kafka-topics.sh –create –zookeeper localhost:2181 –replication-factor 1 –partitions 1 –topic sms</p>
</blockquote>
<p>  view all created topics</p>
<blockquote>
<p>$ bin/kafka-topics.sh –list –zookeeper localhost:2181<br>      sms<br>      email<br>      test  </p>
</blockquote>
<p>  view email topics properties</p>
<blockquote>
<p>$ bin/kafka-topics.sh –describe –zookeeper localhost:2181 –topic email<br>  Topic:email  PartitionCount:1    ReplicationFactor:1 Configs:<br>      Topic: email Partition: 0    Leader: 0   Replicas: 0 Isr: 0  </p>
</blockquote>
<p>  producer connect Kafka Broker  to send a test messages</p>
<blockquote>
<p>$bin/kafka-console-producer.sh –broker-list 192.168.1.215:9092 –topic email<br>      SLF4J: Failed to load class “org.slf4j.impl.StaticLoggerBinder”.<br>      SLF4J: Defaulting to no-operation (NOP) logger implementation<br>      SLF4J: See <a href="http://www.slf4j.org/codes.html#StaticLoggerBinder" target="_blank" rel="external">http://www.slf4j.org/codes.html#StaticLoggerBinder</a> for further details.<br>      Hello World  </p>
</blockquote>
<p>  consumer connect Zookeeper to get messages</p>
<blockquote>
<p>$bin/kafka-console-consumer.sh –zookeeper 192.168.1.215:2181 –topic email –from-beginning  </p>
</blockquote>
<pre><code>SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.  
SLF4J: Defaulting to no-operation (NOP) logger implementation  
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.  
Hello World
</code></pre><p>  delete all message in a topic in a kafka cluster env</p>
<blockquote>
<p>Tested in Kafka 0.8.2, for the quick-start example: First, Add one line to server.properties file under config folder:</p>
<blockquote>
<p>delete.topic.enable=true<br>  then, you can run this command:</p>
</blockquote>
<p>bin/kafka-topics.sh –zookeeper localhost:2181 –delete –topic test</p>
</blockquote>
<h5 id="3.2">3.2 install kafka with docker </h5>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">usefull link:</div><div class="line"></div><div class="line">#</div><div class="line">http://blog.jaceklaskowski.pl/2015/07/14/apache-kafka-on-docker.html?mkt_tok=3RkMMJWWfF9wsRonuqTMZKXonjHpfsX57ukoWaC0lMI%2F0ER3fOvrPUfGjI4ATctmI%2BSLDwEYGJlv6SgFQ7LMMaZq1rgMXBk%3D</div></pre></td></tr></table></figure>
<h2 id="13">13. dockerfile for flume http agent</h2>

<pre><code>FROM probablyfine/flume

RUN apt-get update -q
RUN apt-get install -y telnet
RUN apt-get install -y curl

ADD ./flume-http.conf /var/tmp/flume-http.conf
ADD ./flume-ng-mongodb-sink-1.0.0.jar /opt/flume/lib/.
ADD ./mongo-java-driver-2.13.0.jar /opt/flume/lib/.

EXPOSE 50004

ENTRYPOINT [ &quot;flume-ng&quot;, &quot;agent&quot;, &quot;-c&quot;, &quot;/opt/flume/conf&quot;, &quot;-f&quot;, &quot;/var/tmp/flume-http.conf&quot;, &quot;-n&quot;, &quot;a1&quot;, &quot;-Dflume.root.logger=INFO,console&quot; ]
</code></pre><h2 id="14">14. config file for flume http agent </h2>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line">a1.sources = r1</div><div class="line">a1.sinks = k1 k2 k3</div><div class="line">a1.channels = c1 c2 c3</div><div class="line"></div><div class="line">#Describe/configure the source</div><div class="line">a1.sources.r1.type= http</div><div class="line">a1.sources.r1.host = 0.0.0.0</div><div class="line">a1.sources.r1.port= 50004</div><div class="line">a1.sources.r1.channels= c1 c2 c3</div><div class="line">#alex</div><div class="line">a1.sources.r1.selector.type = multiplexing</div><div class="line">a1.sources.r1.selector.header = type</div><div class="line">#映射允许每个值通道可以重叠。默认值可以包含任意数量的通道。</div><div class="line">a1.sources.r1.selector.mapping.applog = c1</div><div class="line">a1.sources.r1.selector.mapping.sms = c2</div><div class="line">a1.sources.r1.selector.mapping.email = c3</div><div class="line">a1.sources.r1.selector.default = c1</div><div class="line"></div><div class="line">#Describe the mongodb sink 1</div><div class="line">a1.sinks.k1.type = org.riderzen.flume.sink.MongoSink</div><div class="line">a1.sinks.k1.host = 192.168.1.215</div><div class="line">a1.sinks.k1.port = 50000</div><div class="line">a1.sinks.k1.model = single</div><div class="line">a1.sinks.k1.db = logdb</div><div class="line">a1.sinks.k1.collection = logtable</div><div class="line">a1.sinks.k1.batch = 100</div><div class="line">a1.sinks.k1.channel = c1</div><div class="line"></div><div class="line">#sink for kafka sms consumer</div><div class="line">a1.sinks.k2.type = org.apache.flume.sink.kafka.KafkaSink</div><div class="line">a1.sinks.k2.topic = sms</div><div class="line">a1.sinks.k2.brokerList = 192.168.1.215:9092</div><div class="line">a1.sinks.k2.requiredAcks = 1</div><div class="line">a1.sinks.k2.batchSize = 20</div><div class="line">a1.sinks.k2.channel = c2</div><div class="line"></div><div class="line">#sink for kafka email consumer</div><div class="line">a1.sinks.k3.type = org.apache.flume.sink.kafka.KafkaSink</div><div class="line">a1.sinks.k3.topic = email</div><div class="line">#config kafka sink to kafka broker directly</div><div class="line">a1.sinks.k3.brokerList = 192.168.1.215:9092</div><div class="line">#config kafka sink to zookeeper cluster</div><div class="line">a1.sinks.k3.zookeeperConnect = 192.168.1.215:2181</div><div class="line">a1.sinks.k3.requiredAcks = 1</div><div class="line">a1.sinks.k3.batchSize = 20</div><div class="line">a1.sinks.k3.channel = c3</div><div class="line"></div><div class="line">#Describe the mongodb sink 2</div><div class="line">#a1.sinks.k2.type = org.riderzen.flume.sink.MongoSink</div><div class="line">#a1.sinks.k2.host = 192.168.1.215</div><div class="line">#a1.sinks.k2.port = 50000</div><div class="line">#a1.sinks.k2.model = single</div><div class="line">#a1.sinks.k2.db = logdb</div><div class="line">#a1.sinks.k2.collection = logtable_1</div><div class="line">#a1.sinks.k2.batch = 100</div><div class="line">#a1.sinks.k2.channel = c2</div><div class="line">##Use a channel which buffers events in memory</div><div class="line">a1.channels.c1.type = memory</div><div class="line">a1.channels.c1.capacity = 1000</div><div class="line">a1.channels.c1.transactionCapacity = 100</div><div class="line">a1.channels.c2.type = memory</div><div class="line">a1.channels.c2.capacity = 1000</div><div class="line">a1.channels.c2.transactionCapacity = 100</div><div class="line">a1.channels.c3.type = memory</div><div class="line">a1.channels.c3.capacity = 1000</div><div class="line">a1.channels.c3.transactionCapacity = 100</div><div class="line"></div><div class="line">#a1.sinks.k2.type = file_roll</div><div class="line">#a1.sinks.k2.sink.directory = /data/work/app/logprog/logs</div><div class="line">#a1.sinks.k2.type = logger</div><div class="line">#a1.sinks.k2.channel = c2</div></pre></td></tr></table></figure>
<p>export HTTP_PROXY=”<a href="http://192.168.1.234:1080" target="_blank" rel="external">http://192.168.1.234:1080</a>“</p>
<p>test for preview</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flume/">flume</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zookeeper/">zookeeper</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-install_kafka_python_docker" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/install_kafka_python_docker/" class="article-date">
  	<time datetime="2016-07-22T06:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/install_kafka_python_docker/">build single zookeeper node and 3 kafka broker use wurstmeister/kafka</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="compose-to-run-all-CONTAINER"><a href="#compose-to-run-all-CONTAINER" class="headerlink" title="compose to run all CONTAINER"></a>compose to run all CONTAINER</h2><blockquote>
<p>edit /etc/hosts add zkserver1 to hosts in all zookeeper node,</p>
<p>$sudo vi /etc/hosts</p>
<p>192.168.1.215   zkserver1</p>
<p>$sudo docker-compose up</p>
<p>or</p>
<p>$sudo docker-compose up -d</p>
</blockquote>
<h2 id="scale-kafka-node"><a href="#scale-kafka-node" class="headerlink" title="scale kafka node"></a>scale kafka node</h2><blockquote>
<p>$sudo docker-compose scale kafka=1</p>
</blockquote>
<h2 id="add-a-broker-manual"><a href="#add-a-broker-manual" class="headerlink" title="add a broker manual"></a>add a broker manual</h2><blockquote>
<p>$sudo docker run -d -e KAFKA_BROKER_ID=3 -e KAFKA_ADVERTISED_HOST_NAME=192.168.1.215 -e KAFKA_ZOOKEEPER_CONNECT=192.168.1.215:2181 -p 9092:9092 wurstmeister/kafka:0.8.2.0</p>
<p>$sudo docker run -e KAFKA_BROKER_ID=3 -e KAFKA_ADVERTISED_HOST_NAME=192.168.1.215 -e KAFKA_ZOOKEEPER_CONNECT=192.168.1.215:2181 -p 9092:9092 wurstmeister/kafka:0.8.2.0</p>
</blockquote>
<h2 id="create-a-topic-with-3-replication-and-1-partition"><a href="#create-a-topic-with-3-replication-and-1-partition" class="headerlink" title="create a topic with 3 replication and 1 partition"></a>create a topic with 3 replication and 1 partition</h2><blockquote>
<p>$bin/kafka-topics.sh –create –zookeeper zkserver1:2181 –replication-factor 3 –partition 1 –topic  zgg.email</p>
</blockquote>
<h2 id="to-get-a-list-of-topics"><a href="#to-get-a-list-of-topics" class="headerlink" title="to get a list of topics"></a>to get a list of topics</h2><blockquote>
<p>$bin/kafka-topics.sh –list –zookeeper zkserver1:2181</p>
</blockquote>
<h2 id="view-topic’s-properties"><a href="#view-topic’s-properties" class="headerlink" title="view topic’s properties"></a>view topic’s properties</h2><blockquote>
<p>$bin/kafka-topics.sh –describe –zookeeper zkserver1:2181 –topic zgg.email</p>
</blockquote>
<h2 id="Starting-a-producer-sending-messages"><a href="#Starting-a-producer-sending-messages" class="headerlink" title="Starting a producer - sending messages"></a>Starting a producer - sending messages</h2><blockquote>
<p>$bin/kafka-console-producer.sh –broker-list zkserver1:11002 zkserver1:11003 zkserver1:11004 –topic zgg.email</p>
</blockquote>
<h2 id="Starting-a-consumer-consuming-messages"><a href="#Starting-a-consumer-consuming-messages" class="headerlink" title="Starting a consumer - consuming messages"></a>Starting a consumer - consuming messages</h2><blockquote>
<p>$bin/kafka-console-consumer.sh –zookeeper zkserver1:2181 –from-beginning –topic zgg.email</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zookeeper/">zookeeper</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-install_flume_kafka_zookeeper_python_docker_desc" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/install_flume_kafka_zookeeper_python_docker_desc/" class="article-date">
  	<time datetime="2016-07-22T06:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/install_flume_kafka_zookeeper_python_docker_desc/">安装flume zookeeper  kafka python 环境 基于docker image 简单描述</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="安装flume-zookeeper-kafka-python-环境-基于docker-image"><a href="#安装flume-zookeeper-kafka-python-环境-基于docker-image" class="headerlink" title="安装flume zookeeper kafka python 环境 基于docker image"></a>安装flume zookeeper kafka python 环境 基于docker image</h1><h2 id="建立zgsystem的消息系统"><a href="#建立zgsystem的消息系统" class="headerlink" title="建立zgsystem的消息系统"></a>建立zgsystem的消息系统</h2><h2 id="Docker-Usage"><a href="#Docker-Usage" class="headerlink" title="Docker Usage"></a>Docker Usage</h2><h3 id="links"><a href="#links" class="headerlink" title="links :"></a>links :</h3><h4 id="About-Docker-Command"><a href="#About-Docker-Command" class="headerlink" title="About Docker Command"></a>About Docker Command</h4><ul>
<li><p>Docker image and container via docker commands (search, pull, run, ps, restart, attach, and rm)<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Commands_for_Images_Container.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Commands_for_Images_Container.php</a></p>
</li>
<li><p>More on Docker Run command<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Run_Command.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Run_Command.php</a></p>
</li>
<li><p>Linking containers and volume for datastore<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Container_Linking_Connect_with_linking_system_Communication_across_links_Environment_variables.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Container_Linking_Connect_with_linking_system_Communication_across_links_Environment_variables.php</a></p>
</li>
</ul>
<h4 id="About-Dockerfile"><a href="#About-Dockerfile" class="headerlink" title="About Dockerfile"></a>About Dockerfile</h4><ul>
<li><p>Dockerfiles : building Docker images automatically - FROM, MAINTAINER, and build context<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically.php</a></p>
</li>
<li><p>Dockerfiles : building Docker images automatically II - revisiting FROM, MAINTAINER, build context, and caching<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically_2.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically_2.php</a></p>
</li>
<li><p>Dockerfiles : building Docker images automatically III - RUN<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically_3.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically_3.php</a></p>
</li>
<li><p>Dockerfile - Build Docker images automatically IV - CMD<br><a href="http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically_4_CMD.php" target="_blank" rel="external">http://www.bogotobogo.com/DevOps/Docker/Docker_Dockerfile_to_build_images_automatically_4_CMD.php</a></p>
</li>
</ul>
<h2 id="Apache-Flume"><a href="#Apache-Flume" class="headerlink" title="Apache Flume"></a>Apache Flume</h2><blockquote>
<p>使用Apache Flume 作为消息收集的通道 ，为不同消息来源定义不同的message type ，如email ，sms ，applog等</p>
<p>路由到不同的Sink 如Mongodb, Log File ,Apache Kafka etc..</p>
<p>所有消息都默认sink为mongodb ，记录所有消息和日志信息</p>
<p>目前使用Sink有，Mongodb ，Kafka ，Log</p>
</blockquote>
<h2 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a>Zookeeper</h2><blockquote>
<p>version : 3.4.6</p>
</blockquote>
<h2 id="Apache-Kafka"><a href="#Apache-Kafka" class="headerlink" title="Apache Kafka"></a>Apache Kafka</h2><blockquote>
<p>version : 2.9.1-0.8.2.2</p>
<p>建立一个Zookeeper ，3个Kafka broker 结构的消息处理系统</p>
<p>用Python实现Kafka Consumer ，处理email 和 sms Topic</p>
</blockquote>
<h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><blockquote>
<p>基于Python 2.7</p>
</blockquote>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><blockquote>
<p>需要修改防火墙，开放相关端口</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/">docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flume/">flume</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/zookeeper/">zookeeper</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-kafka-usage" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/kafka-usage/" class="article-date">
  	<time datetime="2016-07-22T06:48:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/kafka-usage/">kafka常用命令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="build-zookeeper"><a href="#build-zookeeper" class="headerlink" title="build zookeeper"></a>build zookeeper</h3><blockquote>
<p>$docker run -d -p 2181:2181 -p 2888:2888 -p 3888:3888 jplock/zookeeper<br>注意： 需要修改防火墙，开放相关端口</p>
<h3 id="build-apache-kafka"><a href="#build-apache-kafka" class="headerlink" title="build apache kafka"></a>build apache kafka</h3><p>pull kafak docker image from  docker hub digitalwonderland/kafka</p>
<p>$sudo docker run -d -e KAFKA_BROKER_ID=1 -e KAFKA_ADVERTISED_HOST_NAME=192.168.1.215 -e KAFKA_ZOOKEEPER_CONNECT=192.168.1.215 digitalwonderland/kafka</p>
</blockquote>
<h3 id="test-realmsg-topic"><a href="#test-realmsg-topic" class="headerlink" title="test realmsg topic"></a>test realmsg topic</h3><blockquote>
<p>create realmsg topic with 1 partition and 1 replication<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$bin/kafka-topics.sh --create --zookeeper 192.168.1.215:2181,192.168.1.208:2181,192.168.1.138:2181 --replication-factor 1 --partition 1 --topic  realmsg</div></pre></td></tr></table></figure></p>
<p>list all exists topics<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$bin/kafka-topics.sh --list --zookeeper 192.168.1.215:2181 --replication-factor 1 --partition 1 --topic realmsg</div></pre></td></tr></table></figure></p>
<p>view realmsg topic info<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$bin/kafka-topics.sh --describe --zookeeper 192.168.1.215:2181 --topic realmsg</div></pre></td></tr></table></figure></p>
<p>create a consumer to test realmsg msg<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$bin/kafka-console-consumer.sh --zookeeper 192.168.1.215:2181 --from-beginning --topic realmsg</div></pre></td></tr></table></figure></p>
<p>create a providor to test realmsg<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$bin/kafka-console-producer.sh --broker-list 192.168.1.215:11002 192.168.1.215:11003 --topic realmsg</div></pre></td></tr></table></figure></p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/">kafka</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 pyxixi2012
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    

<script>
	var yiliaConfig = {
		fancybox: undefined,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






  </div>
</body>
</html>